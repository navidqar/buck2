"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[359],{28453:(e,i,n)=>{n.d(i,{R:()=>c,x:()=>a});var o=n(96540);const t={},s=o.createContext(t);function c(e){const i=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),o.createElement(s.Provider,{value:i},e.children)}},88416:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>r,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"concepts/isolation_dir","title":"Isolation dir","description":"Every buck2 daemon has an \\"isolation directory\\" which acts as an isolation","source":"@site/../docs/concepts/isolation_dir.md","sourceDirName":"concepts","slug":"/concepts/isolation_dir","permalink":"/docs/concepts/isolation_dir","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"isolation_dir","title":"Isolation dir"},"sidebar":"main","previous":{"title":"Labels","permalink":"/docs/concepts/labels"},"next":{"title":".buckconfig","permalink":"/docs/concepts/buckconfig"}}');var t=n(74848),s=n(28453);const c={id:"isolation_dir",title:"Isolation dir"},a=void 0,r={},l=[{value:"Isolation dir uses",id:"isolation-dir-uses",level:2},{value:"How to set the isolation dir for a command",id:"how-to-set-the-isolation-dir-for-a-command",level:2},{value:"Isolation dir buck-out path",id:"isolation-dir-buck-out-path",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.p,{children:["Every ",(0,t.jsx)(i.code,{children:"buck2"}),' daemon has an "isolation directory" which acts as an isolation\nmechanism. This enables the ability to have multiple independent daemons, each\nwith a different isolation dir.']}),"\n",(0,t.jsxs)(i.p,{children:["Different daemons enable the concurrent execution of commands, as a ",(0,t.jsx)(i.strong,{children:"single\ndaemon can generally execute only a single command at a time"}),". Most buck2\ncommands only act in their own specified isolation dir. For example,\n",(0,t.jsx)(i.code,{children:"buck2 kill"})," will only kill the daemon associated to the default isolation-dir\n(",(0,t.jsx)(i.code,{children:"v2"}),"). Exceptions to this rule include ",(0,t.jsx)(i.code,{children:"buck2 killall"})," command, which will kill\nall buck2 processes on the machine."]}),"\n",(0,t.jsxs)(i.p,{children:["WARNING: Isolation dirs have a very important consequence: ",(0,t.jsx)(i.code,{children:"buck2"})," invocations\nwith ",(0,t.jsx)(i.em,{children:"different"})," isolation dirs ",(0,t.jsxs)(i.strong,{children:["never share ",(0,t.jsx)(i.em,{children:"any"})," cached artifacts"]}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"isolation-dir-uses",children:"Isolation dir uses"}),"\n",(0,t.jsx)(i.p,{children:"Isolation dirs are also relied on for developer environment tooling (e.g. LSPs)\nthat have to run in the background without affecting the users manually\ntriggered builds."}),"\n",(0,t.jsxs)(i.p,{children:["Also isolation dirs are used to allow for\n",(0,t.jsx)(i.a,{href:"/docs/users/faq/common_issues#are-multiple-concurrent-commands-supported",children:"recursive invocations"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"how-to-set-the-isolation-dir-for-a-command",children:"How to set the isolation dir for a command"}),"\n",(0,t.jsxs)(i.p,{children:["The default isolation dir is ",(0,t.jsx)(i.code,{children:"v2"}),". Thus any ",(0,t.jsx)(i.code,{children:"buck2"})," command without an explicit\nisolation dir is equivalent to"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-sh",children:"$ buck2 --isolation-dir v2 $ARGS\n"})}),"\n",(0,t.jsxs)(i.p,{children:["The isolation dir can also be set via the ",(0,t.jsx)(i.code,{children:"BUCK_ISOLATION_DIR"})," env var."]}),"\n",(0,t.jsxs)(i.p,{children:["NOTE: ",(0,t.jsx)(i.code,{children:"--isolation-dir"})," arg must ",(0,t.jsx)(i.em,{children:"always"})," appear immediately after ",(0,t.jsx)(i.code,{children:"buck2"}),". For\nexample, ",(0,t.jsx)(i.code,{children:"buck2 build --isolation-dir v2 $ARGS"})," is an invalid command."]}),"\n",(0,t.jsx)(i.h2,{id:"isolation-dir-buck-out-path",children:"Isolation dir buck-out path"}),"\n",(0,t.jsxs)(i.p,{children:["The isolation dir specifies the root directory in ",(0,t.jsx)(i.a,{href:"/docs/concepts/buck_out",children:(0,t.jsx)(i.code,{children:"buck-out"})}),"\nwhich will be used to isolate a daemon. With the default ",(0,t.jsx)(i.code,{children:"v2"})," isolation dir,\n",(0,t.jsx)(i.code,{children:"buck2"})," will be using the ",(0,t.jsx)(i.code,{children:"$PROJECT_ROOT/buck-out/v2"})," directory for all target\noutputs and internal metadata. ",(0,t.jsx)(i.code,{children:"$PROJECT_ROOT"})," refers to the directory where the\n",(0,t.jsx)(i.a,{href:"/docs/concepts/glossary#project",children:"project"})," lives."]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);